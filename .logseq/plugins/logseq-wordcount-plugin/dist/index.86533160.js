var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},e={},n={},r=t.parcelRequire23e7;function o(t){if(!t||0===t.length)return 0;let e=t=t.replace(/[\u007F-\u00FE.,\/#!$%\^&*;:{}=\_`~()>\\]/g," "),n=t;e=e.replace(/[^!-~\d\s]+/gi," "),n=n.replace(/[!-~\d\s]+/gi,"");const r=e.match(/[\u00ff-\uffff]|\S+/g)?.filter((t=>"-"!==t)),o=n.match(/[\u00ff-\uffff]|\S+/g);return(r?r.length:0)+(o?o.length:0)}function i(t,e){let n=0;if("words"===e){function r(t){for(let i=0;i<t.length;i++)logseq.settings.forceWordCount?n+=0===(e=t[i].content).length?0:e.split(" ").filter((function(t){return""!=t})).length:n+=o(t[i].content),t[i].children&&r(t[i].children);var e}return r(t),n}if("chars"===e){function r(t){for(let e=0;e<t.length;e++)n+=t[e].content.length,t[e].children&&r(t[e].children)}return r(t),n}return 0}function a(t,e,n,r,o){logseq.provideUI({key:e,slot:t,reset:!0,template:`\n          <span class="wordcount-btn" data-slot-id="${e}" data-wordcount-id="${e}">${function(){const{wordCountStr:t,characterCountStr:e,wordTargetStr:i,characterTargetStr:a}=logseq.settings;if(void 0===r){if(n.startsWith(":wordcount_"))return`${t} ${o}`;if(n.startsWith(":wordcountchar_"))return`${e} ${o}`;if(n.startsWith(":wordcount-page_"))return`${t} ${o||0}`}else{const t=(o/parseInt(r)*100).toFixed(1);if(n.startsWith(":wordcount_"))return`${i} ${t}% (${o}/${r})`;if(n.startsWith(":wordcountchar_"))return`${a} ${t}% (${o}/${r})`}}()}</span>`})}null==r&&((r=function(t){if(t in e)return e[t].exports;if(t in n){var r=n[t];delete n[t];var o={id:t,exports:{}};return e[t]=o,r.call(o.exports,o,o.exports),o.exports}var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(t,e){n[t]=e},t.parcelRequire23e7=r),r.register("3hE9n",(function(e,n){var r;self,r=()=>(()=>{var r={227:(t,e,n)=>{var r=n(155);e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;e.splice(1,0,n,"color: inherit");let r=0,o=0;e[0].replace(/%[a-zA-Z%]/g,(t=>{"%%"!==t&&(r++,"%c"===t&&(o=r))})),e.splice(o,0,n)},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(t){}},e.load=function(){let t;try{t=e.storage.getItem("debug")}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG),t},e.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},e.storage=function(){try{return localStorage}catch(t){}}(),e.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.log=console.debug||console.log||(()=>{}),t.exports=n(447)(e);const{formatters:o}=t.exports;o.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},447:(t,e,n)=>{t.exports=function(t){function e(t){let n,o,i,a=null;function s(...t){if(!s.enabled)return;const r=s,o=Number(new Date),i=o-(n||o);r.diff=i,r.prev=n,r.curr=o,n=o,t[0]=e.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let a=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,((n,o)=>{if("%%"===n)return"%";a++;const i=e.formatters[o];if("function"==typeof i){const e=t[a];n=i.call(r,e),t.splice(a,1),a--}return n})),e.formatArgs.call(r,t),(r.log||e.log).apply(r,t)}return s.namespace=t,s.useColors=e.useColors(),s.color=e.selectColor(t),s.extend=r,s.destroy=e.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(o!==e.namespaces&&(o=e.namespaces,i=e.enabled(t)),i),set:t=>{a=t}}),"function"==typeof e.init&&e.init(s),s}function r(t,n){const r=e(this.namespace+(void 0===n?":":n)+t);return r.log=this.log,r}function o(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return e.debug=e,e.default=e,e.coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){const t=[...e.names.map(o),...e.skips.map(o).map((t=>"-"+t))].join(",");return e.enable(""),t},e.enable=function(t){let n;e.save(t),e.namespaces=t,e.names=[],e.skips=[];const r=("string"==typeof t?t:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(t=r[n].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.slice(1)+"$")):e.names.push(new RegExp("^"+t+"$")))},e.enabled=function(t){if("*"===t[t.length-1])return!0;let n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=n(824),e.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach((n=>{e[n]=t[n]})),e.names=[],e.skips=[],e.formatters={},e.selectColor=function(t){let n=0;for(let e=0;e<t.length;e++)n=(n<<5)-n+t.charCodeAt(e),n|=0;return e.colors[Math.abs(n)%e.colors.length]},e.enable(e.load()),e}},856:function(t){t.exports=function(){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,n){return e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},e(t,n)}function n(t,r,o){return n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}()?Reflect.construct:function(t,n,r){var o=[null];o.push.apply(o,n);var i=new(Function.bind.apply(t,o));return r&&e(i,r.prototype),i},n.apply(null,arguments)}function r(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var i=Object.hasOwnProperty,a=Object.setPrototypeOf,s=Object.isFrozen,c=Object.getPrototypeOf,l=Object.getOwnPropertyDescriptor,u=Object.freeze,d=Object.seal,f=Object.create,p="undefined"!=typeof Reflect&&Reflect,h=p.apply,g=p.construct;h||(h=function(t,e,n){return t.apply(e,n)}),u||(u=function(t){return t}),d||(d=function(t){return t}),g||(g=function(t,e){return n(t,r(e))});var m=E(Array.prototype.forEach),v=E(Array.prototype.pop),y=E(Array.prototype.push),b=E(String.prototype.toLowerCase),_=E(String.prototype.match),w=E(String.prototype.replace),x=E(String.prototype.indexOf),C=E(String.prototype.trim),S=E(RegExp.prototype.test),O=function(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return g(t,n)}}(TypeError);function E(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return h(t,e,r)}}function k(t,e){a&&a(t,null);for(var n=e.length;n--;){var r=e[n];if("string"==typeof r){var o=b(r);o!==r&&(s(e)||(e[n]=o),r=o)}t[r]=!0}return t}function A(t){var e,n=f(null);for(e in t)h(i,t,[e])&&(n[e]=t[e]);return n}function j(t,e){for(;null!==t;){var n=l(t,e);if(n){if(n.get)return E(n.get);if("function"==typeof n.value)return E(n.value)}t=c(t)}return function(t){return console.warn("fallback value for",t),null}}var T=u(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),I=u(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),F=u(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),L=u(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),N=u(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),M=u(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),R=u(["#text"]),P=u(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),$=u(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),D=u(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),U=u(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),z=d(/\{\{[\w\W]*|[\w\W]*\}\}/gm),q=d(/<%[\w\W]*|[\w\W]*%>/gm),H=d(/^data-[\-\w.\u00B7-\uFFFF]/),B=d(/^aria-[\-\w]+$/),W=d(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),G=d(/^(?:\w+script|data):/i),J=d(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Z=d(/^html$/i);return function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,o=function(t){return e(t)};if(o.version="2.3.8",o.removed=[],!n||!n.document||9!==n.document.nodeType)return o.isSupported=!1,o;var i=n.document,a=n.document,s=n.DocumentFragment,c=n.HTMLTemplateElement,l=n.Node,d=n.Element,f=n.NodeFilter,p=n.NamedNodeMap,h=void 0===p?n.NamedNodeMap||n.MozNamedAttrMap:p,g=n.HTMLFormElement,E=n.DOMParser,V=n.trustedTypes,K=d.prototype,Y=j(K,"cloneNode"),Q=j(K,"nextSibling"),X=j(K,"childNodes"),tt=j(K,"parentNode");if("function"==typeof c){var et=a.createElement("template");et.content&&et.content.ownerDocument&&(a=et.content.ownerDocument)}var nt=function(e,n){if("object"!==t(e)||"function"!=typeof e.createPolicy)return null;var r=null,o="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(o)&&(r=n.currentScript.getAttribute(o));var i="dompurify"+(r?"#"+r:"");try{return e.createPolicy(i,{createHTML:function(t){return t}})}catch(t){return console.warn("TrustedTypes policy "+i+" could not be created."),null}}(V,i),rt=nt?nt.createHTML(""):"",ot=a,it=ot.implementation,at=ot.createNodeIterator,st=ot.createDocumentFragment,ct=ot.getElementsByTagName,lt=i.importNode,ut={};try{ut=A(a).documentMode?a.documentMode:{}}catch(t){}var dt={};o.isSupported="function"==typeof tt&&it&&void 0!==it.createHTMLDocument&&9!==ut;var ft,pt,ht=z,gt=q,mt=H,vt=B,yt=G,bt=J,_t=W,wt=null,xt=k({},[].concat(r(T),r(I),r(F),r(N),r(R))),Ct=null,St=k({},[].concat(r(P),r($),r(D),r(U))),Ot=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Et=null,kt=null,At=!0,jt=!0,Tt=!1,It=!1,Ft=!1,Lt=!1,Nt=!1,Mt=!1,Rt=!1,Pt=!1,$t=!0,Dt=!0,Ut=!1,zt={},qt=null,Ht=k({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Bt=null,Wt=k({},["audio","video","img","source","image","track"]),Gt=null,Jt=k({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Zt="http://www.w3.org/1998/Math/MathML",Vt="http://www.w3.org/2000/svg",Kt="http://www.w3.org/1999/xhtml",Yt=Kt,Qt=!1,Xt=["application/xhtml+xml","text/html"],te=null,ee=a.createElement("form"),ne=function(t){return t instanceof RegExp||t instanceof Function},re=function(e){te&&te===e||(e&&"object"===t(e)||(e={}),e=A(e),wt="ALLOWED_TAGS"in e?k({},e.ALLOWED_TAGS):xt,Ct="ALLOWED_ATTR"in e?k({},e.ALLOWED_ATTR):St,Gt="ADD_URI_SAFE_ATTR"in e?k(A(Jt),e.ADD_URI_SAFE_ATTR):Jt,Bt="ADD_DATA_URI_TAGS"in e?k(A(Wt),e.ADD_DATA_URI_TAGS):Wt,qt="FORBID_CONTENTS"in e?k({},e.FORBID_CONTENTS):Ht,Et="FORBID_TAGS"in e?k({},e.FORBID_TAGS):{},kt="FORBID_ATTR"in e?k({},e.FORBID_ATTR):{},zt="USE_PROFILES"in e&&e.USE_PROFILES,At=!1!==e.ALLOW_ARIA_ATTR,jt=!1!==e.ALLOW_DATA_ATTR,Tt=e.ALLOW_UNKNOWN_PROTOCOLS||!1,It=e.SAFE_FOR_TEMPLATES||!1,Ft=e.WHOLE_DOCUMENT||!1,Mt=e.RETURN_DOM||!1,Rt=e.RETURN_DOM_FRAGMENT||!1,Pt=e.RETURN_TRUSTED_TYPE||!1,Nt=e.FORCE_BODY||!1,$t=!1!==e.SANITIZE_DOM,Dt=!1!==e.KEEP_CONTENT,Ut=e.IN_PLACE||!1,_t=e.ALLOWED_URI_REGEXP||_t,Yt=e.NAMESPACE||Kt,e.CUSTOM_ELEMENT_HANDLING&&ne(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ot.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&ne(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ot.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Ot.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ft=ft=-1===Xt.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,pt="application/xhtml+xml"===ft?function(t){return t}:b,It&&(jt=!1),Rt&&(Mt=!0),zt&&(wt=k({},r(R)),Ct=[],!0===zt.html&&(k(wt,T),k(Ct,P)),!0===zt.svg&&(k(wt,I),k(Ct,$),k(Ct,U)),!0===zt.svgFilters&&(k(wt,F),k(Ct,$),k(Ct,U)),!0===zt.mathMl&&(k(wt,N),k(Ct,D),k(Ct,U))),e.ADD_TAGS&&(wt===xt&&(wt=A(wt)),k(wt,e.ADD_TAGS)),e.ADD_ATTR&&(Ct===St&&(Ct=A(Ct)),k(Ct,e.ADD_ATTR)),e.ADD_URI_SAFE_ATTR&&k(Gt,e.ADD_URI_SAFE_ATTR),e.FORBID_CONTENTS&&(qt===Ht&&(qt=A(qt)),k(qt,e.FORBID_CONTENTS)),Dt&&(wt["#text"]=!0),Ft&&k(wt,["html","head","body"]),wt.table&&(k(wt,["tbody"]),delete Et.tbody),u&&u(e),te=e)},oe=k({},["mi","mo","mn","ms","mtext"]),ie=k({},["foreignobject","desc","title","annotation-xml"]),ae=k({},["title","style","font","a","script"]),se=k({},I);k(se,F),k(se,L);var ce=k({},N);k(ce,M);var le=function(t){y(o.removed,{element:t});try{t.parentNode.removeChild(t)}catch(e){try{t.outerHTML=rt}catch(e){t.remove()}}},ue=function(t,e){try{y(o.removed,{attribute:e.getAttributeNode(t),from:e})}catch(t){y(o.removed,{attribute:null,from:e})}if(e.removeAttribute(t),"is"===t&&!Ct[t])if(Mt||Rt)try{le(e)}catch(t){}else try{e.setAttribute(t,"")}catch(t){}},de=function(t){var e,n;if(Nt)t="<remove></remove>"+t;else{var r=_(t,/^[\r\n\t ]+/);n=r&&r[0]}"application/xhtml+xml"===ft&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");var o=nt?nt.createHTML(t):t;if(Yt===Kt)try{e=(new E).parseFromString(o,ft)}catch(t){}if(!e||!e.documentElement){e=it.createDocument(Yt,"template",null);try{e.documentElement.innerHTML=Qt?"":o}catch(t){}}var i=e.body||e.documentElement;return t&&n&&i.insertBefore(a.createTextNode(n),i.childNodes[0]||null),Yt===Kt?ct.call(e,Ft?"html":"body")[0]:Ft?e.documentElement:i},fe=function(t){return at.call(t.ownerDocument||t,t,f.SHOW_ELEMENT|f.SHOW_COMMENT|f.SHOW_TEXT,null,!1)},pe=function(e){return"object"===t(l)?e instanceof l:e&&"object"===t(e)&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},he=function(t,e,n){dt[t]&&m(dt[t],(function(t){t.call(o,e,n,te)}))},ge=function(t){var e;if(he("beforeSanitizeElements",t,null),function(t){return t instanceof g&&("string"!=typeof t.nodeName||"string"!=typeof t.textContent||"function"!=typeof t.removeChild||!(t.attributes instanceof h)||"function"!=typeof t.removeAttribute||"function"!=typeof t.setAttribute||"string"!=typeof t.namespaceURI||"function"!=typeof t.insertBefore)}(t))return le(t),!0;if(S(/[\u0080-\uFFFF]/,t.nodeName))return le(t),!0;var n=pt(t.nodeName);if(he("uponSanitizeElement",t,{tagName:n,allowedTags:wt}),t.hasChildNodes()&&!pe(t.firstElementChild)&&(!pe(t.content)||!pe(t.content.firstElementChild))&&S(/<[/\w]/g,t.innerHTML)&&S(/<[/\w]/g,t.textContent))return le(t),!0;if("select"===n&&S(/<template/i,t.innerHTML))return le(t),!0;if(!wt[n]||Et[n]){if(!Et[n]&&ve(n)){if(Ot.tagNameCheck instanceof RegExp&&S(Ot.tagNameCheck,n))return!1;if(Ot.tagNameCheck instanceof Function&&Ot.tagNameCheck(n))return!1}if(Dt&&!qt[n]){var r=tt(t)||t.parentNode,i=X(t)||t.childNodes;if(i&&r)for(var a=i.length-1;a>=0;--a)r.insertBefore(Y(i[a],!0),Q(t))}return le(t),!0}return t instanceof d&&!function(t){var e=tt(t);e&&e.tagName||(e={namespaceURI:Kt,tagName:"template"});var n=b(t.tagName),r=b(e.tagName);return t.namespaceURI===Vt?e.namespaceURI===Kt?"svg"===n:e.namespaceURI===Zt?"svg"===n&&("annotation-xml"===r||oe[r]):Boolean(se[n]):t.namespaceURI===Zt?e.namespaceURI===Kt?"math"===n:e.namespaceURI===Vt?"math"===n&&ie[r]:Boolean(ce[n]):t.namespaceURI===Kt&&!(e.namespaceURI===Vt&&!ie[r])&&!(e.namespaceURI===Zt&&!oe[r])&&!ce[n]&&(ae[n]||!se[n])}(t)?(le(t),!0):"noscript"!==n&&"noembed"!==n||!S(/<\/no(script|embed)/i,t.innerHTML)?(It&&3===t.nodeType&&(e=t.textContent,e=w(e,ht," "),e=w(e,gt," "),t.textContent!==e&&(y(o.removed,{element:t.cloneNode()}),t.textContent=e)),he("afterSanitizeElements",t,null),!1):(le(t),!0)},me=function(t,e,n){if($t&&("id"===e||"name"===e)&&(n in a||n in ee))return!1;if(jt&&!kt[e]&&S(mt,e));else if(At&&S(vt,e));else if(!Ct[e]||kt[e]){if(!(ve(t)&&(Ot.tagNameCheck instanceof RegExp&&S(Ot.tagNameCheck,t)||Ot.tagNameCheck instanceof Function&&Ot.tagNameCheck(t))&&(Ot.attributeNameCheck instanceof RegExp&&S(Ot.attributeNameCheck,e)||Ot.attributeNameCheck instanceof Function&&Ot.attributeNameCheck(e))||"is"===e&&Ot.allowCustomizedBuiltInElements&&(Ot.tagNameCheck instanceof RegExp&&S(Ot.tagNameCheck,n)||Ot.tagNameCheck instanceof Function&&Ot.tagNameCheck(n))))return!1}else if(Gt[e]);else if(S(_t,w(n,bt,"")));else if("src"!==e&&"xlink:href"!==e&&"href"!==e||"script"===t||0!==x(n,"data:")||!Bt[t])if(Tt&&!S(yt,w(n,bt,"")));else if(n)return!1;return!0},ve=function(t){return t.indexOf("-")>0},ye=function(t){var e,n,r,i;he("beforeSanitizeAttributes",t,null);var a=t.attributes;if(a){var s={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Ct};for(i=a.length;i--;){var c=e=a[i],l=c.name,u=c.namespaceURI;if(n="value"===l?e.value:C(e.value),r=pt(l),s.attrName=r,s.attrValue=n,s.keepAttr=!0,s.forceKeepAttr=void 0,he("uponSanitizeAttribute",t,s),n=s.attrValue,!s.forceKeepAttr&&(ue(l,t),s.keepAttr))if(S(/\/>/i,n))ue(l,t);else{It&&(n=w(n,ht," "),n=w(n,gt," "));var d=pt(t.nodeName);if(me(d,r,n))try{u?t.setAttributeNS(u,l,n):t.setAttribute(l,n),v(o.removed)}catch(t){}}}he("afterSanitizeAttributes",t,null)}},be=function t(e){var n,r=fe(e);for(he("beforeSanitizeShadowDOM",e,null);n=r.nextNode();)he("uponSanitizeShadowNode",n,null),ge(n)||(n.content instanceof s&&t(n.content),ye(n));he("afterSanitizeShadowDOM",e,null)};return o.sanitize=function(e,r){var a,c,u,d,f;if((Qt=!e)&&(e="\x3c!--\x3e"),"string"!=typeof e&&!pe(e)){if("function"!=typeof e.toString)throw O("toString is not a function");if("string"!=typeof(e=e.toString()))throw O("dirty is not a string, aborting")}if(!o.isSupported){if("object"===t(n.toStaticHTML)||"function"==typeof n.toStaticHTML){if("string"==typeof e)return n.toStaticHTML(e);if(pe(e))return n.toStaticHTML(e.outerHTML)}return e}if(Lt||re(r),o.removed=[],"string"==typeof e&&(Ut=!1),Ut){if(e.nodeName){var p=pt(e.nodeName);if(!wt[p]||Et[p])throw O("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof l)1===(c=(a=de("\x3c!----\x3e")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===c.nodeName||"HTML"===c.nodeName?a=c:a.appendChild(c);else{if(!Mt&&!It&&!Ft&&-1===e.indexOf("<"))return nt&&Pt?nt.createHTML(e):e;if(!(a=de(e)))return Mt?null:Pt?rt:""}a&&Nt&&le(a.firstChild);for(var h=fe(Ut?e:a);u=h.nextNode();)3===u.nodeType&&u===d||ge(u)||(u.content instanceof s&&be(u.content),ye(u),d=u);if(d=null,Ut)return e;if(Mt){if(Rt)for(f=st.call(a.ownerDocument);a.firstChild;)f.appendChild(a.firstChild);else f=a;return Ct.shadowroot&&(f=lt.call(i,f,!0)),f}var g=Ft?a.outerHTML:a.innerHTML;return Ft&&wt["!doctype"]&&a.ownerDocument&&a.ownerDocument.doctype&&a.ownerDocument.doctype.name&&S(Z,a.ownerDocument.doctype.name)&&(g="<!DOCTYPE "+a.ownerDocument.doctype.name+">\n"+g),It&&(g=w(g,ht," "),g=w(g,gt," ")),nt&&Pt?nt.createHTML(g):g},o.setConfig=function(t){re(t),Lt=!0},o.clearConfig=function(){te=null,Lt=!1},o.isValidAttribute=function(t,e,n){te||re({});var r=pt(t),o=pt(e);return me(r,o,n)},o.addHook=function(t,e){"function"==typeof e&&(dt[t]=dt[t]||[],y(dt[t],e))},o.removeHook=function(t){if(dt[t])return v(dt[t])},o.removeHooks=function(t){dt[t]&&(dt[t]=[])},o.removeAllHooks=function(){dt={}},o}()}()},729:t=>{var e=Object.prototype.hasOwnProperty,n="~";function r(){}function o(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function i(t,e,r,i,a){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new o(r,i||t,a),c=n?n+e:e;return t._events[c]?t._events[c].fn?t._events[c]=[t._events[c],s]:t._events[c].push(s):(t._events[c]=s,t._eventsCount++),t}function a(t,e){0==--t._eventsCount?t._events=new r:delete t._events[e]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var t,r,o=[];if(0===this._eventsCount)return o;for(r in t=this._events)e.call(t,r)&&o.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(t)):o},s.prototype.listeners=function(t){var e=n?n+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,i=r.length,a=new Array(i);o<i;o++)a[o]=r[o].fn;return a},s.prototype.listenerCount=function(t){var e=n?n+t:t,r=this._events[e];return r?r.fn?1:r.length:0},s.prototype.emit=function(t,e,r,o,i,a){var s=n?n+t:t;if(!this._events[s])return!1;var c,l,u=this._events[s],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,r),!0;case 4:return u.fn.call(u.context,e,r,o),!0;case 5:return u.fn.call(u.context,e,r,o,i),!0;case 6:return u.fn.call(u.context,e,r,o,i,a),!0}for(l=1,c=new Array(d-1);l<d;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var f,p=u.length;for(l=0;l<p;l++)switch(u[l].once&&this.removeListener(t,u[l].fn,void 0,!0),d){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,e);break;case 3:u[l].fn.call(u[l].context,e,r);break;case 4:u[l].fn.call(u[l].context,e,r,o);break;default:if(!c)for(f=1,c=new Array(d-1);f<d;f++)c[f-1]=arguments[f];u[l].fn.apply(u[l].context,c)}}return!0},s.prototype.on=function(t,e,n){return i(this,t,e,n,!1)},s.prototype.once=function(t,e,n){return i(this,t,e,n,!0)},s.prototype.removeListener=function(t,e,r,o){var i=n?n+t:t;if(!this._events[i])return this;if(!e)return a(this,i),this;var s=this._events[i];if(s.fn)s.fn!==e||o&&!s.once||r&&s.context!==r||a(this,i);else{for(var c=0,l=[],u=s.length;c<u;c++)(s[c].fn!==e||o&&!s[c].once||r&&s[c].context!==r)&&l.push(s[c]);l.length?this._events[i]=1===l.length?l[0]:l:a(this,i)}return this},s.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&a(this,e)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,t.exports=s},717:t=>{"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},824:t=>{var e=1e3,n=60*e,r=60*n,o=24*r;function i(t,e,n,r){var o=e>=1.5*n;return Math.round(t/n)+" "+r+(o?"s":"")}t.exports=function(t,a){a=a||{};var s=typeof t;if("string"===s&&t.length>0)return function(t){if(!((t=String(t)).length>100)){var i=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(i){var a=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"weeks":case"week":case"w":return 6048e5*a;case"days":case"day":case"d":return a*o;case"hours":case"hour":case"hrs":case"hr":case"h":return a*r;case"minutes":case"minute":case"mins":case"min":case"m":return a*n;case"seconds":case"second":case"secs":case"sec":case"s":return a*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}(t);if("number"===s&&isFinite(t))return a.long?function(t){var a=Math.abs(t);return a>=o?i(t,a,o,"day"):a>=r?i(t,a,r,"hour"):a>=n?i(t,a,n,"minute"):a>=e?i(t,a,e,"second"):t+" ms"}(t):function(t){var i=Math.abs(t);return i>=o?Math.round(t/o)+"d":i>=r?Math.round(t/r)+"h":i>=n?Math.round(t/n)+"m":i>=e?Math.round(t/e)+"s":t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},520:(t,e,n)=>{var r=n(155),o="win32"===r.platform,i=n(539);function a(t,e){for(var n=[],r=0;r<t.length;r++){var o=t[r];o&&"."!==o&&(".."===o?n.length&&".."!==n[n.length-1]?n.pop():e&&n.push(".."):n.push(o))}return n}function s(t){for(var e=t.length-1,n=0;n<=e&&!t[n];n++);for(var r=e;r>=0&&!t[r];r--);return 0===n&&r===e?t:n>r?[]:t.slice(n,r+1)}var c=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,l=/^([\s\S]*?)((?:\.{1,2}|[^\\\/]+?|)(\.[^.\/\\]*|))(?:[\\\/]*)$/,u={};function d(t){var e=c.exec(t),n=(e[1]||"")+(e[2]||""),r=e[3]||"",o=l.exec(r);return[n,o[1],o[2],o[3]]}function f(t){var e=c.exec(t),n=e[1]||"",r=!!n&&":"!==n[1];return{device:n,isUnc:r,isAbsolute:r||!!e[2],tail:e[3]}}function p(t){return"\\\\"+t.replace(/^[\\\/]+/,"").replace(/[\\\/]+/g,"\\")}u.resolve=function(){for(var t="",e="",n=!1,o=arguments.length-1;o>=-1;o--){var s;if(o>=0?s=arguments[o]:t?(s=r.env["="+t])&&s.substr(0,3).toLowerCase()===t.toLowerCase()+"\\"||(s=t+"\\"):s=r.cwd(),!i.isString(s))throw new TypeError("Arguments to path.resolve must be strings");if(s){var c=f(s),l=c.device,u=c.isUnc,d=c.isAbsolute,h=c.tail;if((!l||!t||l.toLowerCase()===t.toLowerCase())&&(t||(t=l),n||(e=h+"\\"+e,n=d),t&&n))break}}return u&&(t=p(t)),t+(n?"\\":"")+(e=a(e.split(/[\\\/]+/),!n).join("\\"))||"."},u.normalize=function(t){var e=f(t),n=e.device,r=e.isUnc,o=e.isAbsolute,i=e.tail,s=/[\\\/]$/.test(i);return(i=a(i.split(/[\\\/]+/),!o).join("\\"))||o||(i="."),i&&s&&(i+="\\"),r&&(n=p(n)),n+(o?"\\":"")+i},u.isAbsolute=function(t){return f(t).isAbsolute},u.join=function(){for(var t=[],e=0;e<arguments.length;e++){var n=arguments[e];if(!i.isString(n))throw new TypeError("Arguments to path.join must be strings");n&&t.push(n)}var r=t.join("\\");return/^[\\\/]{2}[^\\\/]/.test(t[0])||(r=r.replace(/^[\\\/]{2,}/,"\\")),u.normalize(r)},u.relative=function(t,e){t=u.resolve(t),e=u.resolve(e);for(var n=t.toLowerCase(),r=e.toLowerCase(),o=s(e.split("\\")),i=s(n.split("\\")),a=s(r.split("\\")),c=Math.min(i.length,a.length),l=c,d=0;d<c;d++)if(i[d]!==a[d]){l=d;break}if(0==l)return e;var f=[];for(d=l;d<i.length;d++)f.push("..");return(f=f.concat(o.slice(l))).join("\\")},u._makeLong=function(t){if(!i.isString(t))return t;if(!t)return"";var e=u.resolve(t);return/^[a-zA-Z]\:\\/.test(e)?"\\\\?\\"+e:/^\\\\[^?.]/.test(e)?"\\\\?\\UNC\\"+e.substring(2):t},u.dirname=function(t){var e=d(t),n=e[0],r=e[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},u.basename=function(t,e){var n=d(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},u.extname=function(t){return d(t)[3]},u.format=function(t){if(!i.isObject(t))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof t);var e=t.root||"";if(!i.isString(e))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof t.root);var n=t.dir,r=t.base||"";return n?n[n.length-1]===u.sep?n+r:n+u.sep+r:r},u.parse=function(t){if(!i.isString(t))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof t);var e=d(t);if(!e||4!==e.length)throw new TypeError("Invalid path '"+t+"'");return{root:e[0],dir:e[0]+e[1].slice(0,-1),base:e[2],ext:e[3],name:e[2].slice(0,e[2].length-e[3].length)}},u.sep="\\",u.delimiter=";";var h=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,g={};function m(t){return h.exec(t).slice(1)}g.resolve=function(){for(var t="",e=!1,n=arguments.length-1;n>=-1&&!e;n--){var o=n>=0?arguments[n]:r.cwd();if(!i.isString(o))throw new TypeError("Arguments to path.resolve must be strings");o&&(t=o+"/"+t,e="/"===o[0])}return(e?"/":"")+(t=a(t.split("/"),!e).join("/"))||"."},g.normalize=function(t){var e=g.isAbsolute(t),n=t&&"/"===t[t.length-1];return(t=a(t.split("/"),!e).join("/"))||e||(t="."),t&&n&&(t+="/"),(e?"/":"")+t},g.isAbsolute=function(t){return"/"===t.charAt(0)},g.join=function(){for(var t="",e=0;e<arguments.length;e++){var n=arguments[e];if(!i.isString(n))throw new TypeError("Arguments to path.join must be strings");n&&(t+=t?"/"+n:n)}return g.normalize(t)},g.relative=function(t,e){t=g.resolve(t).substr(1),e=g.resolve(e).substr(1);for(var n=s(t.split("/")),r=s(e.split("/")),o=Math.min(n.length,r.length),i=o,a=0;a<o;a++)if(n[a]!==r[a]){i=a;break}var c=[];for(a=i;a<n.length;a++)c.push("..");return(c=c.concat(r.slice(i))).join("/")},g._makeLong=function(t){return t},g.dirname=function(t){var e=m(t),n=e[0],r=e[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},g.basename=function(t,e){var n=m(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},g.extname=function(t){return m(t)[3]},g.format=function(t){if(!i.isObject(t))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof t);var e=t.root||"";if(!i.isString(e))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof t.root);return(t.dir?t.dir+g.sep:"")+(t.base||"")},g.parse=function(t){if(!i.isString(t))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof t);var e=m(t);if(!e||4!==e.length)throw new TypeError("Invalid path '"+t+"'");return e[1]=e[1]||"",e[2]=e[2]||"",e[3]=e[3]||"",{root:e[0],dir:e[0]+e[1].slice(0,-1),base:e[2],ext:e[3],name:e[2].slice(0,e[2].length-e[3].length)}},g.sep="/",g.delimiter=":",t.exports=o?u:g,t.exports.posix=g,t.exports.win32=u},155:t=>{var e,n,r=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function a(t){if(e===setTimeout)return setTimeout(t,0);if((e===o||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:o}catch(t){e=o}try{n="function"==typeof clearTimeout?clearTimeout:i}catch(t){n=i}}();var s,c=[],l=!1,u=-1;function d(){l&&s&&(l=!1,s.length?c=s.concat(c):u=-1,c.length&&f())}function f(){if(!l){var t=a(d);l=!0;for(var e=c.length;e;){for(s=c,c=[];++u<e;)s&&s[u].run();u=-1,e=c.length}s=null,l=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===i||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function h(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new p(t,e)),1!==c.length||l||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=h,r.addListener=h,r.once=h,r.off=h,r.removeListener=h,r.removeAllListeners=h,r.emit=h,r.prependListener=h,r.prependOnceListener=h,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},384:t=>{t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},539:(t,e,n)=>{var r=n(155),o=/%[sdj%]/g;e.format=function(t){if(!v(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(s(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,i=r.length,a=String(t).replace(o,(function(t){if("%%"===t)return"%";if(n>=i)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}})),c=r[n];n<i;c=r[++n])g(c)||!_(c)?a+=" "+c:a+=" "+s(c);return a},e.deprecate=function(t,o){if(y(n.g.process))return function(){return e.deprecate(t,o).apply(this,arguments)};if(!0===r.noDeprecation)return t;var i=!1;return function(){if(!i){if(r.throwDeprecation)throw new Error(o);r.traceDeprecation?console.trace(o):console.error(o),i=!0}return t.apply(this,arguments)}};var i,a={};function s(t,n){var r={seen:[],stylize:l};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),h(n)?r.showHidden=n:n&&e._extend(r,n),y(r.showHidden)&&(r.showHidden=!1),y(r.depth)&&(r.depth=2),y(r.colors)&&(r.colors=!1),y(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),u(r,t,r.depth)}function c(t,e){var n=s.styles[e];return n?"["+s.colors[n][0]+"m"+t+"["+s.colors[n][1]+"m":t}function l(t,e){return t}function u(t,n,r){if(t.customInspect&&n&&C(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o=n.inspect(r,t);return v(o)||(o=u(t,o,r)),o}var i=function(t,e){if(y(e))return t.stylize("undefined","undefined");if(v(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return m(e)?t.stylize(""+e,"number"):h(e)?t.stylize(""+e,"boolean"):g(e)?t.stylize("null","null"):void 0}(t,n);if(i)return i;var a=Object.keys(n),s=function(t){var e={};return t.forEach((function(t,n){e[t]=!0})),e}(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(n)),x(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return d(n);if(0===a.length){if(C(n)){var c=n.name?": "+n.name:"";return t.stylize("[Function"+c+"]","special")}if(b(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(w(n))return t.stylize(Date.prototype.toString.call(n),"date");if(x(n))return d(n)}var l,_="",S=!1,O=["{","}"];return p(n)&&(S=!0,O=["[","]"]),C(n)&&(_=" [Function"+(n.name?": "+n.name:"")+"]"),b(n)&&(_=" "+RegExp.prototype.toString.call(n)),w(n)&&(_=" "+Date.prototype.toUTCString.call(n)),x(n)&&(_=" "+d(n)),0!==a.length||S&&0!=n.length?r<0?b(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),l=S?function(t,e,n,r,o){for(var i=[],a=0,s=e.length;a<s;++a)k(e,String(a))?i.push(f(t,e,n,r,String(a),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(f(t,e,n,r,o,!0))})),i}(t,n,r,s,a):a.map((function(e){return f(t,n,r,s,e,S)})),t.seen.pop(),function(t,e,n){return t.reduce((function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}(l,_,O)):O[0]+_+O[1]}function d(t){return"["+Error.prototype.toString.call(t)+"]"}function f(t,e,n,r,o,i){var a,s,c;if((c=Object.getOwnPropertyDescriptor(e,o)||{value:e[o]}).get?s=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(s=t.stylize("[Setter]","special")),k(r,o)||(a="["+o+"]"),s||(t.seen.indexOf(c.value)<0?(s=g(n)?u(t,c.value,null):u(t,c.value,n-1)).indexOf("\n")>-1&&(s=i?s.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+s.split("\n").map((function(t){return"   "+t})).join("\n")):s=t.stylize("[Circular]","special")),y(a)){if(i&&o.match(/^\d+$/))return s;(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function p(t){return Array.isArray(t)}function h(t){return"boolean"==typeof t}function g(t){return null===t}function m(t){return"number"==typeof t}function v(t){return"string"==typeof t}function y(t){return void 0===t}function b(t){return _(t)&&"[object RegExp]"===S(t)}function _(t){return"object"==typeof t&&null!==t}function w(t){return _(t)&&"[object Date]"===S(t)}function x(t){return _(t)&&("[object Error]"===S(t)||t instanceof Error)}function C(t){return"function"==typeof t}function S(t){return Object.prototype.toString.call(t)}function O(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(t){if(y(i)&&(i=r.env.NODE_DEBUG||""),t=t.toUpperCase(),!a[t])if(new RegExp("\\b"+t+"\\b","i").test(i)){var n=r.pid;a[t]=function(){var r=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,r)}}else a[t]=function(){};return a[t]},e.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=p,e.isBoolean=h,e.isNull=g,e.isNullOrUndefined=function(t){return null==t},e.isNumber=m,e.isString=v,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=y,e.isRegExp=b,e.isObject=_,e.isDate=w,e.isError=x,e.isFunction=C,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(384);var E=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function k(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",function(){var t=new Date,e=[O(t.getHours()),O(t.getMinutes()),O(t.getSeconds())].join(":");return[t.getDate(),E[t.getMonth()],e].join(" ")}(),e.format.apply(e,arguments))},e.inherits=n(717),e._extend=function(t,e){if(!e||!_(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}},o={};function i(t){var e=o[t];if(void 0!==e)return e.exports;var n=o[t]={exports:{}};return r[t].call(n.exports,n,n.exports,i),n.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var a={};return(()=>{i.r(a),i.d(a,{LSPluginUser:()=>br,setupPluginUserInstance:()=>_r});var r=i(520);i(856);const o=function(t,e){return t===e||t!=t&&e!=e},s=function(t,e){for(var n=t.length;n--;)if(o(t[n][0],e))return n;return-1};var c=Array.prototype.splice;function l(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}l.prototype.clear=function(){this.__data__=[],this.size=0},l.prototype.delete=function(t){var e=this.__data__,n=s(e,t);return!(n<0||(n==e.length-1?e.pop():c.call(e,n,1),--this.size,0))},l.prototype.get=function(t){var e=this.__data__,n=s(e,t);return n<0?void 0:e[n][1]},l.prototype.has=function(t){return s(this.__data__,t)>-1},l.prototype.set=function(t,e){var n=this.__data__,r=s(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this};const u=l,d="object"==typeof t&&t&&t.Object===Object&&t;var f="object"==typeof self&&self&&self.Object===Object&&self;const p=d||f||Function("return this")(),h=p.Symbol;var g=Object.prototype,m=g.hasOwnProperty,v=g.toString,y=h?h.toStringTag:void 0,b=Object.prototype.toString,_=h?h.toStringTag:void 0;const w=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":_&&_ in Object(t)?function(t){var e=m.call(t,y),n=t[y];try{t[y]=void 0;var r=!0}catch(t){}var o=v.call(t);return r&&(e?t[y]=n:delete t[y]),o}(t):function(t){return b.call(t)}(t)},x=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},C=function(t){if(!x(t))return!1;var e=w(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},S=p["__core-js_shared__"];var O,E=(O=/[^.]+$/.exec(S&&S.keys&&S.keys.IE_PROTO||""))?"Symbol(src)_1."+O:"",k=Function.prototype.toString;const A=function(t){if(null!=t){try{return k.call(t)}catch(t){}try{return t+""}catch(t){}}return""};var j=/^\[object .+?Constructor\]$/,T=Function.prototype,I=Object.prototype,F=T.toString,L=I.hasOwnProperty,N=RegExp("^"+F.call(L).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const M=function(t){return!(!x(t)||function(t){return!!E&&E in t}(t))&&(C(t)?N:j).test(A(t))},R=function(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return M(n)?n:void 0},P=R(p,"Map"),$=R(Object,"create");var D=Object.prototype.hasOwnProperty,U=Object.prototype.hasOwnProperty;function z(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}z.prototype.clear=function(){this.__data__=$?$(null):{},this.size=0},z.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},z.prototype.get=function(t){var e=this.__data__;if($){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return D.call(e,t)?e[t]:void 0},z.prototype.has=function(t){var e=this.__data__;return $?void 0!==e[t]:U.call(e,t)},z.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=$&&void 0===e?"__lodash_hash_undefined__":e,this};const q=z,H=function(t,e){var n=t.__data__;return function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}(e)?n["string"==typeof e?"string":"hash"]:n.map};function B(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}B.prototype.clear=function(){this.size=0,this.__data__={hash:new q,map:new(P||u),string:new q}},B.prototype.delete=function(t){var e=H(this,t).delete(t);return this.size-=e?1:0,e},B.prototype.get=function(t){return H(this,t).get(t)},B.prototype.has=function(t){return H(this,t).has(t)},B.prototype.set=function(t,e){var n=H(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this};const W=B;function G(t){var e=this.__data__=new u(t);this.size=e.size}G.prototype.clear=function(){this.__data__=new u,this.size=0},G.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},G.prototype.get=function(t){return this.__data__.get(t)},G.prototype.has=function(t){return this.__data__.has(t)},G.prototype.set=function(t,e){var n=this.__data__;if(n instanceof u){var r=n.__data__;if(!P||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new W(r)}return n.set(t,e),this.size=n.size,this};const J=G,Z=function(){try{var t=R(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),V=function(t,e,n){"__proto__"==e&&Z?Z(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n},K=function(t,e,n){(void 0!==n&&!o(t[e],n)||void 0===n&&!(e in t))&&V(t,e,n)},Y=function(t,e,n){for(var r=-1,o=Object(t),i=n(t),a=i.length;a--;){var s=i[++r];if(!1===e(o[s],s,o))break}return t};var Q=n&&!n.nodeType&&n,X=Q&&e&&!e.nodeType&&e,tt=X&&X.exports===Q?p.Buffer:void 0,et=tt?tt.allocUnsafe:void 0;const nt=p.Uint8Array,rt=function(t,e){var n=e?function(t){var e=new t.constructor(t.byteLength);return new nt(e).set(new nt(t)),e}(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)};var ot=Object.create;const it=function(){function t(){}return function(e){if(!x(e))return{};if(ot)return ot(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}(),at=function(t,e){return function(n){return t(e(n))}},st=at(Object.getPrototypeOf,Object);var ct=Object.prototype;const lt=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||ct)},ut=function(t){return null!=t&&"object"==typeof t},dt=function(t){return ut(t)&&"[object Arguments]"==w(t)};var ft=Object.prototype,pt=ft.hasOwnProperty,ht=ft.propertyIsEnumerable;const gt=dt(function(){return arguments}())?dt:function(t){return ut(t)&&pt.call(t,"callee")&&!ht.call(t,"callee")},mt=Array.isArray,vt=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},yt=function(t){return null!=t&&vt(t.length)&&!C(t)};var bt=n&&!n.nodeType&&n,_t=bt&&e&&!e.nodeType&&e,wt=_t&&_t.exports===bt?p.Buffer:void 0;const xt=(wt?wt.isBuffer:void 0)||function(){return!1};var Ct=Function.prototype,St=Object.prototype,Ot=Ct.toString,Et=St.hasOwnProperty,kt=Ot.call(Object),At={};At["[object Float32Array]"]=At["[object Float64Array]"]=At["[object Int8Array]"]=At["[object Int16Array]"]=At["[object Int32Array]"]=At["[object Uint8Array]"]=At["[object Uint8ClampedArray]"]=At["[object Uint16Array]"]=At["[object Uint32Array]"]=!0,At["[object Arguments]"]=At["[object Array]"]=At["[object ArrayBuffer]"]=At["[object Boolean]"]=At["[object DataView]"]=At["[object Date]"]=At["[object Error]"]=At["[object Function]"]=At["[object Map]"]=At["[object Number]"]=At["[object Object]"]=At["[object RegExp]"]=At["[object Set]"]=At["[object String]"]=At["[object WeakMap]"]=!1;var jt=n&&!n.nodeType&&n,Tt=jt&&e&&!e.nodeType&&e,It=Tt&&Tt.exports===jt&&d.process,Ft=function(){try{return Tt&&Tt.require&&Tt.require("util").types||It&&It.binding&&It.binding("util")}catch(t){}}(),Lt=Ft&&Ft.isTypedArray;const Nt=Lt?function(t){return function(e){return t(e)}}(Lt):function(t){return ut(t)&&vt(t.length)&&!!At[w(t)]},Mt=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]};var Rt=Object.prototype.hasOwnProperty;const Pt=function(t,e,n){var r=t[e];Rt.call(t,e)&&o(r,n)&&(void 0!==n||e in t)||V(t,e,n)};var $t=/^(?:0|[1-9]\d*)$/;const Dt=function(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&$t.test(t))&&t>-1&&t%1==0&&t<e};var Ut=Object.prototype.hasOwnProperty;const zt=function(t,e){var n=mt(t),r=!n&&gt(t),o=!n&&!r&&xt(t),i=!n&&!r&&!o&&Nt(t),a=n||r||o||i,s=a?function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}(t.length,String):[],c=s.length;for(var l in t)!e&&!Ut.call(t,l)||a&&("length"==l||o&&("offset"==l||"parent"==l)||i&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Dt(l,c))||s.push(l);return s};var qt=Object.prototype.hasOwnProperty;const Ht=function(t){if(!x(t))return function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}(t);var e=lt(t),n=[];for(var r in t)("constructor"!=r||!e&&qt.call(t,r))&&n.push(r);return n},Bt=function(t){return yt(t)?zt(t,!0):Ht(t)},Wt=function(t){return function(t,e,n,r){var o=!n;n||(n={});for(var i=-1,a=e.length;++i<a;){var s=e[i],c=r?r(n[s],t[s],s,n,t):void 0;void 0===c&&(c=t[s]),o?V(n,s,c):Pt(n,s,c)}return n}(t,Bt(t))},Gt=function(t,e,n,r,o,i,a){var s=Mt(t,n),c=Mt(e,n),l=a.get(c);if(l)K(t,n,l);else{var u=i?i(s,c,n+"",t,e,a):void 0,d=void 0===u;if(d){var f=mt(c),p=!f&&xt(c),h=!f&&!p&&Nt(c);u=c,f||p||h?mt(s)?u=s:function(t){return ut(t)&&yt(t)}(s)?u=function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}(s):p?(d=!1,u=function(t,e){if(e)return t.slice();var n=t.length,r=et?et(n):new t.constructor(n);return t.copy(r),r}(c,!0)):h?(d=!1,u=rt(c,!0)):u=[]:function(t){if(!ut(t)||"[object Object]"!=w(t))return!1;var e=st(t);if(null===e)return!0;var n=Et.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Ot.call(n)==kt}(c)||gt(c)?(u=s,gt(s)?u=Wt(s):x(s)&&!C(s)||(u=function(t){return"function"!=typeof t.constructor||lt(t)?{}:it(st(t))}(c))):d=!1}d&&(a.set(c,u),o(u,c,r,i,a),a.delete(c)),K(t,n,u)}},Jt=function t(e,n,r,o,i){e!==n&&Y(n,(function(a,s){if(i||(i=new J),x(a))Gt(e,n,s,r,t,o,i);else{var c=o?o(Mt(e,s),a,s+"",e,n,i):void 0;void 0===c&&(c=a),K(e,s,c)}}),Bt)},Zt=function(t){return t};var Vt=Math.max;const Kt=function(t){return function(){return t}},Yt=Z?function(t,e){return Z(t,"toString",{configurable:!0,enumerable:!1,value:Kt(e),writable:!0})}:Zt;var Qt=Date.now;const Xt=function(t){var e=0,n=0;return function(){var r=Qt(),o=16-(r-n);if(n=r,o>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(Yt),te=function(t,e){return Xt(function(t,e,n){return e=Vt(void 0===e?t.length-1:e,0),function(){for(var r=arguments,o=-1,i=Vt(r.length-e,0),a=Array(i);++o<i;)a[o]=r[e+o];o=-1;for(var s=Array(e+1);++o<e;)s[o]=r[o];return s[e]=n(a),function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}(t,this,s)}}(t,e,Zt),t+"")},ee=function(t,e,n){if(!x(n))return!1;var r=typeof e;return!!("number"==r?yt(n)&&Dt(e,n.length):"string"==r&&e in n)&&o(n[e],t)},ne=function(t){return te((function(e,n){var r=-1,o=n.length,i=o>1?n[o-1]:void 0,a=o>2?n[2]:void 0;for(i=t.length>3&&"function"==typeof i?(o--,i):void 0,a&&ee(n[0],n[1],a)&&(i=o<3?void 0:i,o=1),e=Object(e);++r<o;){var s=n[r];s&&t(e,s,r)}return e}))}((function(t,e,n){Jt(t,e,n)}));var re=function(){return re=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},re.apply(this,arguments)};function oe(t){return t.toLowerCase()}Object.create,Object.create;var ie=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],ae=/[^A-Z0-9]+/gi;function se(t,e,n){return e instanceof RegExp?t.replace(e,n):e.reduce((function(t,e){return t.replace(e,n)}),t)}var ce=i(729),le=i.n(ce);function ue(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const de="win32"===navigator.platform.toLowerCase()?r.win32:r.posix,fe=function(t,e){return void 0===e&&(e={}),function(t,e){return void 0===e&&(e={}),function(t,e){void 0===e&&(e={});for(var n=e.splitRegexp,r=void 0===n?ie:n,o=e.stripRegexp,i=void 0===o?ae:o,a=e.transform,s=void 0===a?oe:a,c=e.delimiter,l=void 0===c?" ":c,u=se(se(t,r,"$1\0$2"),i,"\0"),d=0,f=u.length;"\0"===u.charAt(d);)d++;for(;"\0"===u.charAt(f-1);)f--;return u.slice(d,f).split("\0").map(s).join(l)}(t,re({delimiter:"."},e))}(t,re({delimiter:"_"},e))},pe=ne;class he extends(le()){constructor(t,e){super(),ue(this,"_tag",void 0),ue(this,"_opts",void 0),ue(this,"_logs",[]),this._tag=t,this._opts=e}write(t,e,n){var r;null!=e&&e.length&&!0===e[e.length-1]&&(n=!0,e.pop());const o=e.reduce(((t,e)=>(e&&e instanceof Error?t+=`${e.message} ${e.stack}`:t+=e.toString(),t)),`[${this._tag}][${(new Date).toLocaleTimeString()}] `);var i;this._logs.push([t,o]),(n||null!==(r=this._opts)&&void 0!==r&&r.console)&&(null===(i=console)||void 0===i||i["ERROR"===t?"error":"debug"](`${t}: ${o}`)),this.emit("change")}clear(){this._logs=[],this.emit("change")}info(...t){this.write("INFO",t)}error(...t){this.write("ERROR",t)}warn(...t){this.write("WARN",t)}setTag(t){this._tag=t}toJSON(){return this._logs}}function ge(t,e){let n,r,o=!1;const i=e=>n=>{t&&clearTimeout(t),e(n),o=!0},a=new Promise(((o,a)=>{n=i(o),r=i(a),t&&(t=setTimeout((()=>r(new Error(`[deferred timeout] ${e}`))),t))}));return{created:Date.now(),setTag:t=>e=t,resolve:n,reject:r,promise:a,get settled(){return o}}}const me=new Map;window.__injectedUIEffects=me;var ve=i(227),ye=i.n(ve);function be(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const _e="application/x-postmate-v1+json";let we=0;const xe={handshake:1,"handshake-reply":1,call:1,emit:1,reply:1,request:1},Ce=(t,e)=>!("string"==typeof e&&t.origin!==e||!t.data||"object"==typeof t.data&&!("postmate"in t.data)||t.data.type!==_e||!xe[t.data.postmate]);class Se{constructor(t){be(this,"parent",void 0),be(this,"frame",void 0),be(this,"child",void 0),be(this,"events",{}),be(this,"childOrigin",void 0),be(this,"listener",void 0),this.parent=t.parent,this.frame=t.frame,this.child=t.child,this.childOrigin=t.childOrigin,this.listener=t=>{if(!Ce(t,this.childOrigin))return!1;const{data:e,name:n}=((t||{}).data||{}).value||{};"emit"===t.data.postmate&&n in this.events&&this.events[n].forEach((t=>{t.call(this,e)}))},this.parent.addEventListener("message",this.listener,!1)}get(t,...e){return new Promise((n=>{const r=++we,o=t=>{t.data.uid===r&&"reply"===t.data.postmate&&(this.parent.removeEventListener("message",o,!1),n(t.data.value))};this.parent.addEventListener("message",o,!1),this.child.postMessage({postmate:"request",type:_e,property:t,args:e,uid:r},this.childOrigin)}))}call(t,e){this.child.postMessage({postmate:"call",type:_e,property:t,data:e},this.childOrigin)}on(t,e){this.events[t]||(this.events[t]=[]),this.events[t].push(e)}destroy(){window.removeEventListener("message",this.listener,!1),this.frame.parentNode.removeChild(this.frame)}}class Oe{constructor(t){be(this,"model",void 0),be(this,"parent",void 0),be(this,"parentOrigin",void 0),be(this,"child",void 0),this.model=t.model,this.parent=t.parent,this.parentOrigin=t.parentOrigin,this.child=t.child,this.child.addEventListener("message",(t=>{if(!Ce(t,this.parentOrigin))return;const{property:e,uid:n,data:r,args:o}=t.data;"call"!==t.data.postmate?((t,e,n)=>{const r="function"==typeof t[e]?t[e].apply(null,n):t[e];return Promise.resolve(r)})(this.model,e,o).then((r=>{t.source.postMessage({property:e,postmate:"reply",type:_e,uid:n,value:r},t.origin)})):e in this.model&&"function"==typeof this.model[e]&&this.model[e](r)}))}emit(t,e){this.parent.postMessage({postmate:"emit",type:_e,value:{name:t,data:e}},this.parentOrigin)}}class Ee{constructor(t){be(this,"container",void 0),be(this,"parent",void 0),be(this,"frame",void 0),be(this,"child",void 0),be(this,"childOrigin",void 0),be(this,"url",void 0),be(this,"model",void 0),this.container=t.container,this.url=t.url,this.parent=window,this.frame=document.createElement("iframe"),t.id&&(this.frame.id=t.id),t.name&&(this.frame.name=t.name),this.frame.classList.add.apply(this.frame.classList,t.classListArray||[]),this.container.appendChild(this.frame),this.child=this.frame.contentWindow,this.model=t.model||{}}sendHandshake(t){const e=(t=>{const e=document.createElement("a");e.href=t;const n=e.protocol.length>4?e.protocol:window.location.protocol,r=e.host.length?"80"===e.port||"443"===e.port?e.hostname:e.host:window.location.host;return e.origin||`${n}//${r}`})(t=t||this.url);let n,r=0;return new Promise(((o,i)=>{const a=t=>!!Ce(t,e)&&("handshake-reply"===t.data.postmate?(clearInterval(n),this.parent.removeEventListener("message",a,!1),this.childOrigin=t.origin,o(new Se(this))):i("Failed handshake"));this.parent.addEventListener("message",a,!1);const s=()=>{r++,this.child.postMessage({postmate:"handshake",type:_e,model:this.model},e),5===r&&clearInterval(n)};this.frame.addEventListener("load",(()=>{s(),n=setInterval(s,500)})),this.frame.src=t}))}destroy(){this.frame.parentNode.removeChild(this.frame)}}be(Ee,"debug",!1),be(Ee,"Model",void 0);class ke{constructor(t){be(this,"child",void 0),be(this,"model",void 0),be(this,"parent",void 0),be(this,"parentOrigin",void 0),this.child=window,this.model=t,this.parent=this.child.parent}sendHandshakeReply(){return new Promise(((t,e)=>{const n=r=>{if(r.data.postmate){if("handshake"===r.data.postmate){this.child.removeEventListener("message",n,!1),r.source.postMessage({postmate:"handshake-reply",type:_e},r.origin),this.parentOrigin=r.origin;const e=r.data.model;return e&&Object.keys(e).forEach((t=>{this.model[t]=e[t]})),t(new Oe(this))}return e("Handshake Reply Failed")}};this.child.addEventListener("message",n,!1)}))}}function Ae(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const{importHTML:je,createSandboxContainer:Te}=window.QSandbox||{};function Ie(t,e){return t.startsWith("http")?fetch(t,e):(t=t.replace("file://",""),new Promise((async(e,n)=>{try{const n=await window.apis.doAction(["readFile",t]);e({text:()=>n})}catch(t){console.error(t),n(t)}})))}class Fe extends(le()){constructor(t){super(),Ae(this,"_pluginLocal",void 0),Ae(this,"_frame",void 0),Ae(this,"_root",void 0),Ae(this,"_loaded",!1),Ae(this,"_unmountFns",[]),this._pluginLocal=t,t._dispose((()=>{this._unmount()}))}async load(){const{name:t,entry:e}=this._pluginLocal.options;if(this.loaded||!e)return;const{template:n,execScripts:r}=await je(e,{fetch:Ie});this._mount(n,document.body);const o=Te(t,{elementGetter:()=>{var t;return null===(t=this._root)||void 0===t?void 0:t.firstChild}}).instance.proxy;o.__shadow_mode__=!0,o.LSPluginLocal=this._pluginLocal,o.LSPluginShadow=this,o.LSPluginUser=o.logseq=new br(this._pluginLocal.toJSON(),this._pluginLocal.caller);const i=await r(o,!0);this._unmountFns.push(i.unmount),this._loaded=!0}_mount(t,e){const n=this._frame=document.createElement("div");n.classList.add("lsp-shadow-sandbox"),n.id=this._pluginLocal.id,this._root=n.attachShadow({mode:"open"}),this._root.innerHTML=`<div>${t}</div>`,e.appendChild(n),this.emit("mounted")}_unmount(){for(const t of this._unmountFns)t&&t.call(null)}destroy(){var t,e;null===(t=this.frame)||void 0===t||null===(e=t.parentNode)||void 0===e||e.removeChild(this.frame)}get loaded(){return this._loaded}get document(){var t;return null===(t=this._root)||void 0===t?void 0:t.firstChild}get frame(){return this._frame}}function Le(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const Ne=ye()("LSPlugin:caller"),Me="#await#response#",Re="#lspmsg#error#",Pe=t=>`#lspmsg#${t}`;class $e extends(le()){constructor(t){super(),Le(this,"_pluginLocal",void 0),Le(this,"_connected",!1),Le(this,"_parent",void 0),Le(this,"_child",void 0),Le(this,"_shadow",void 0),Le(this,"_status",void 0),Le(this,"_userModel",{}),Le(this,"_call",void 0),Le(this,"_callUserModel",void 0),Le(this,"_debugTag",""),this._pluginLocal=t,t&&(this._debugTag=t.debugTag)}async connectToChild(){if(this._connected)return;const{shadow:t}=this._pluginLocal;t?await this._setupShadowSandbox():await this._setupIframeSandbox()}async connectToParent(t={}){if(this._connected)return;const e=this,n=null!=this._pluginLocal;let r=0,o=0;const i=new Map,a=ge(6e4),s=this._extendUserModel({"#lspmsg#ready#":async t=>{s[Pe(null==t?void 0:t.pid)]=({type:t,payload:n})=>{Ne(`[host (_call) -> *user] ${this._debugTag}`,t,n),e.emit(t,n)},await a.resolve()},"#lspmsg#beforeunload#":async t=>{const n=ge(1e4);e.emit("beforeunload",Object.assign({actor:n},t)),await n.promise},"#lspmsg#settings#":async({type:t,payload:n})=>{e.emit("settings:changed",n)},"#lspmsg#":async({ns:t,type:n,payload:r})=>{Ne(`[host (async) -> *user] ${this._debugTag} ns=${t} type=${n}`,r),t&&t.startsWith("hook")?e.emit(`${t}:${n}`,r):e.emit(n,r)},"#lspmsg#reply#":({_sync:t,result:e})=>{if(Ne(`[sync host -> *user] #${t}`,e),i.has(t)){const n=i.get(t);n&&(null!=e&&e.hasOwnProperty(Re)?n.reject(e[Re]):n.resolve(e),i.delete(t))}},...t});var c;if(n)return await a.promise,JSON.parse(JSON.stringify(null===(c=this._pluginLocal)||void 0===c?void 0:c.toJSON()));const l=new ke(s).sendHandshakeReply();return this._status="pending",await l.then((t=>{this._child=t,this._connected=!0,this._call=async(e,n={},r)=>{if(r){const t=++o;i.set(t,r),n._sync=t,r.setTag(`async call #${t}`),Ne(`async call #${t}`)}return t.emit(Pe(s.baseInfo.id),{type:e,payload:n}),null==r?void 0:r.promise},this._callUserModel=async(t,e)=>{try{s[t](e)}catch(e){Ne(`[model method] #${t} not existed`)}},r=setInterval((()=>{if(i.size>100)for(const[t,e]of i)e.settled&&i.delete(t)}),18e5)})).finally((()=>{this._status=void 0})),await a.promise,s.baseInfo}async call(t,e={}){var n;return null===(n=this._call)||void 0===n?void 0:n.call(this,t,e)}async callAsync(t,e={}){var n;const r=ge(1e4);return null===(n=this._call)||void 0===n?void 0:n.call(this,t,e,r)}async callUserModel(t,...e){var n;return null===(n=this._callUserModel)||void 0===n?void 0:n.apply(this,[t,...e])}async callUserModelAsync(t,...e){var n;return t=`${Me}${t}`,null===(n=this._callUserModel)||void 0===n?void 0:n.apply(this,[t,...e])}async _setupIframeSandbox(){const t=this._pluginLocal,e=t.id,n=`${e}_lsp_main`,r=new URL(t.options.entry);r.searchParams.set("__v__",t.options.version);const o=document.querySelector(`#${n}`);o&&o.parentElement.removeChild(o);const i=document.createElement("div");i.classList.add("lsp-iframe-sandbox-container"),i.id=n,i.dataset.pid=e;try{var a;const t=null===(a=await this._pluginLocal._loadLayoutsData())||void 0===a?void 0:a.$$0;if(t){i.dataset.inited_layout="true";let{width:e,height:n,left:r,top:o,vw:a,vh:s}=t;r=Math.max(r,0),r="number"==typeof a?`${Math.min(100*r/a,99)}%`:`${r}px`,o=Math.max(o,45),o="number"==typeof s?`${Math.min(100*o/s,99)}%`:`${o}px`,Object.assign(i.style,{width:e+"px",height:n+"px",left:r,top:o})}}catch(t){console.error("[Restore Layout Error]",t)}document.body.appendChild(i);const s=new Ee({id:e+"_iframe",container:i,url:r.href,classListArray:["lsp-iframe-sandbox"],model:{baseInfo:JSON.parse(JSON.stringify(t.toJSON()))}});let c,l=s.sendHandshake();return this._status="pending",new Promise(((e,n)=>{c=setTimeout((()=>{n(new Error("handshake Timeout")),s.destroy()}),4e3),l.then((n=>{this._parent=n,this._connected=!0,this.emit("connected"),n.on(Pe(t.id),(({type:t,payload:e})=>{var n,r;Ne("[user -> *host] ",t,e),null===(n=this._pluginLocal)||void 0===n||n.emit(t,e||{}),null===(r=this._pluginLocal)||void 0===r||r.caller.emit(t,e||{})})),this._call=async(...e)=>{await n.call(Pe(t.id),{type:e[0],payload:Object.assign(e[1]||{},{$$pid:t.id})})},this._callUserModel=async(t,...e)=>{if(t.startsWith(Me))return await n.get(t.replace(Me,""),...e);n.call(t,null==e?void 0:e[0])},e(null)})).catch((t=>{n(t)})).finally((()=>{clearTimeout(c)}))})).catch((t=>{throw Ne("[iframe sandbox] error",t),t})).finally((()=>{this._status=void 0}))}async _setupShadowSandbox(){const t=this._pluginLocal,e=this._shadow=new Fe(t);try{this._status="pending",await e.load(),this._connected=!0,this.emit("connected"),this._call=async(e,n={},r)=>{var o;return r&&(n.actor=r),null===(o=this._pluginLocal)||void 0===o||o.emit(e,Object.assign(n,{$$pid:t.id})),null==r?void 0:r.promise},this._callUserModel=async(...t)=>{var e;let n=t[0];null!==(e=n)&&void 0!==e&&e.startsWith(Me)&&(n=n.replace(Me,""));const r=t[1]||{},o=this._userModel[n];"function"==typeof o&&await o.call(null,r)}}catch(t){throw Ne("[shadow sandbox] error",t),t}finally{this._status=void 0}}_extendUserModel(t){return Object.assign(this._userModel,t)}_getSandboxIframeContainer(){var t;return null===(t=this._parent)||void 0===t?void 0:t.frame.parentNode}_getSandboxShadowContainer(){var t;return null===(t=this._shadow)||void 0===t?void 0:t.frame.parentNode}_getSandboxIframeRoot(){var t;return null===(t=this._parent)||void 0===t?void 0:t.frame}_getSandboxShadowRoot(){var t;return null===(t=this._shadow)||void 0===t?void 0:t.frame}set debugTag(t){this._debugTag=t}async destroy(){var t;let e=null;this._parent&&(e=this._getSandboxIframeContainer(),await this._parent.destroy()),this._shadow&&(e=this._getSandboxShadowContainer(),this._shadow.destroy()),null===(t=e)||void 0===t||t.parentNode.removeChild(e)}}function De(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class Ue{constructor(t,e){De(this,"ctx",void 0),De(this,"opts",void 0),this.ctx=t,this.opts=e}get ctxId(){return this.ctx.baseInfo.id}setItem(t,e){var n;return this.ctx.caller.callAsync("api:call",{method:"write-plugin-storage-file",args:[this.ctxId,t,e,null===(n=this.opts)||void 0===n?void 0:n.assets]})}getItem(t){var e;return this.ctx.caller.callAsync("api:call",{method:"read-plugin-storage-file",args:[this.ctxId,t,null===(e=this.opts)||void 0===e?void 0:e.assets]})}removeItem(t){var e;return this.ctx.caller.call("api:call",{method:"unlink-plugin-storage-file",args:[this.ctxId,t,null===(e=this.opts)||void 0===e?void 0:e.assets]})}allKeys(){var t;return this.ctx.caller.callAsync("api:call",{method:"list-plugin-storage-files",args:[this.ctxId,null===(t=this.opts)||void 0===t?void 0:t.assets]})}clear(){var t;return this.ctx.caller.call("api:call",{method:"clear-plugin-storage-files",args:[this.ctxId,null===(t=this.opts)||void 0===t?void 0:t.assets]})}hasItem(t){var e;return this.ctx.caller.callAsync("api:call",{method:"exist-plugin-storage-file",args:[this.ctxId,t,null===(e=this.opts)||void 0===e?void 0:e.assets]})}}class ze{constructor(t){var e;e=void 0,"ctx"in this?Object.defineProperty(this,"ctx",{value:e,enumerable:!0,configurable:!0,writable:!0}):this.ctx=e,this.ctx=t}get React(){return this.ensureHostScope().React}get ReactDOM(){return this.ensureHostScope().ReactDOM}get pluginLocal(){return this.ensureHostScope().LSPluginCore.ensurePlugin(this.ctx.baseInfo.id)}invokeExperMethod(t,...e){var n,r;const o=this.ensureHostScope();return t=null===(n=fe(t))||void 0===n?void 0:n.toLowerCase(),null===(r=o.logseq.api["exper_"+t])||void 0===r?void 0:r.apply(o,e)}async loadScripts(...t){(t=t.map((t=>null!=t&&t.startsWith("http")?t:this.ctx.resolveResourceFullUrl(t)))).unshift(this.ctx.baseInfo.id),await this.invokeExperMethod("loadScripts",...t)}registerFencedCodeRenderer(t,e){return this.ensureHostScope().logseq.api.exper_register_fenced_code_renderer(this.ctx.baseInfo.id,t,e)}registerExtensionsEnhancer(t,e){const n=this.ensureHostScope();return"katex"===t&&n.katex&&e(n.katex).catch(console.error),n.logseq.api.exper_register_extensions_enhancer(this.ctx.baseInfo.id,t,e)}ensureHostScope(){if(window===top)throw new Error("Can not access host scope!");return top}}function qe(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const He=t=>`task_callback_${t}`;class Be{constructor(t,e,n={}){qe(this,"_client",void 0),qe(this,"_requestId",void 0),qe(this,"_requestOptions",void 0),qe(this,"_promise",void 0),qe(this,"_aborted",!1),this._client=t,this._requestId=e,this._requestOptions=n,this._promise=new Promise(((t,e)=>{if(!this._requestId)return e(null);this._client.once(He(this._requestId),(n=>{n&&n instanceof Error?e(n):t(n)}))}));const{success:r,fail:o,final:i}=this._requestOptions;this._promise.then((t=>{null==r||r(t)})).catch((t=>{null==o||o(t)})).finally((()=>{null==i||i()}))}abort(){this._requestOptions.abortable&&!this._aborted&&(this._client.ctx._execCallableAPI("http_request_abort",this._requestId),this._aborted=!0)}get promise(){return this._promise}get client(){return this._client}get requestId(){return this._requestId}}class We extends ce.EventEmitter{constructor(t){super(),qe(this,"_ctx",void 0),this._ctx=t,this.ctx.caller.on("#lsp#request#callback",(t=>{const e=null==t?void 0:t.requestId;e&&this.emit(He(e),null==t?void 0:t.payload)}))}static createRequestTask(t,e,n){return new Be(t,e,n)}async _request(t){const e=this.ctx.baseInfo.id,{success:n,fail:r,final:o,...i}=t,a=this.ctx.Experiments.invokeExperMethod("request",e,i),s=We.createRequestTask(this.ctx.Request,a,t);return i.abortable?s:s.promise}get ctx(){return this._ctx}}const Ge=at(Object.keys,Object);var Je=Object.prototype.hasOwnProperty;const Ze=function(t){return yt(t)?zt(t):function(t){if(!lt(t))return Ge(t);var e=[];for(var n in Object(t))Je.call(t,n)&&"constructor"!=n&&e.push(n);return e}(t)};function Ve(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new W;++e<n;)this.add(t[e])}Ve.prototype.add=Ve.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Ve.prototype.has=function(t){return this.__data__.has(t)};const Ke=Ve,Ye=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1},Qe=function(t,e){return t.has(e)},Xe=function(t,e,n,r,o,i){var a=1&n,s=t.length,c=e.length;if(s!=c&&!(a&&c>s))return!1;var l=i.get(t),u=i.get(e);if(l&&u)return l==e&&u==t;var d=-1,f=!0,p=2&n?new Ke:void 0;for(i.set(t,e),i.set(e,t);++d<s;){var h=t[d],g=e[d];if(r)var m=a?r(g,h,d,e,t,i):r(h,g,d,t,e,i);if(void 0!==m){if(m)continue;f=!1;break}if(p){if(!Ye(e,(function(t,e){if(!Qe(p,e)&&(h===t||o(h,t,n,r,i)))return p.push(e)}))){f=!1;break}}else if(h!==g&&!o(h,g,n,r,i)){f=!1;break}}return i.delete(t),i.delete(e),f},tn=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n},en=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n};var nn=h?h.prototype:void 0,rn=nn?nn.valueOf:void 0;const on=function(t,e,n,r,i,a,s){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!a(new nt(t),new nt(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return o(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var c=tn;case"[object Set]":var l=1&r;if(c||(c=en),t.size!=e.size&&!l)return!1;var u=s.get(t);if(u)return u==e;r|=2,s.set(t,e);var d=Xe(c(t),c(e),r,i,a,s);return s.delete(t),d;case"[object Symbol]":if(rn)return rn.call(t)==rn.call(e)}return!1};var an=Object.prototype.propertyIsEnumerable,sn=Object.getOwnPropertySymbols;const cn=sn?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var n=-1,r=null==t?0:t.length,o=0,i=[];++n<r;){var a=t[n];e(a,n,t)&&(i[o++]=a)}return i}(sn(t),(function(e){return an.call(t,e)})))}:function(){return[]},ln=function(t){return function(t,e,n){var r=e(t);return mt(t)?r:function(t,e){for(var n=-1,r=e.length,o=t.length;++n<r;)t[o+n]=e[n];return t}(r,n(t))}(t,Ze,cn)};var un=Object.prototype.hasOwnProperty;const dn=R(p,"DataView"),fn=R(p,"Promise"),pn=R(p,"Set"),hn=R(p,"WeakMap");var gn="[object Map]",mn="[object Promise]",vn="[object Set]",yn="[object WeakMap]",bn="[object DataView]",_n=A(dn),wn=A(P),xn=A(fn),Cn=A(pn),Sn=A(hn),On=w;(dn&&On(new dn(new ArrayBuffer(1)))!=bn||P&&On(new P)!=gn||fn&&On(fn.resolve())!=mn||pn&&On(new pn)!=vn||hn&&On(new hn)!=yn)&&(On=function(t){var e=w(t),n="[object Object]"==e?t.constructor:void 0,r=n?A(n):"";if(r)switch(r){case _n:return bn;case wn:return gn;case xn:return mn;case Cn:return vn;case Sn:return yn}return e});const En=On;var kn="[object Arguments]",An="[object Array]",jn="[object Object]",Tn=Object.prototype.hasOwnProperty;const In=function(t,e,n,r,o,i){var a=mt(t),s=mt(e),c=a?An:En(t),l=s?An:En(e),u=(c=c==kn?jn:c)==jn,d=(l=l==kn?jn:l)==jn,f=c==l;if(f&&xt(t)){if(!xt(e))return!1;a=!0,u=!1}if(f&&!u)return i||(i=new J),a||Nt(t)?Xe(t,e,n,r,o,i):on(t,e,c,n,r,o,i);if(!(1&n)){var p=u&&Tn.call(t,"__wrapped__"),h=d&&Tn.call(e,"__wrapped__");if(p||h){var g=p?t.value():t,m=h?e.value():e;return i||(i=new J),o(g,m,n,r,i)}}return!!f&&(i||(i=new J),function(t,e,n,r,o,i){var a=1&n,s=ln(t),c=s.length;if(c!=ln(e).length&&!a)return!1;for(var l=c;l--;){var u=s[l];if(!(a?u in e:un.call(e,u)))return!1}var d=i.get(t),f=i.get(e);if(d&&f)return d==e&&f==t;var p=!0;i.set(t,e),i.set(e,t);for(var h=a;++l<c;){var g=t[u=s[l]],m=e[u];if(r)var v=a?r(m,g,u,e,t,i):r(g,m,u,t,e,i);if(!(void 0===v?g===m||o(g,m,n,r,i):v)){p=!1;break}h||(h="constructor"==u)}if(p&&!h){var y=t.constructor,b=e.constructor;y==b||!("constructor"in t)||!("constructor"in e)||"function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b||(p=!1)}return i.delete(t),i.delete(e),p}(t,e,n,r,o,i))},Fn=function t(e,n,r,o,i){return e===n||(null==e||null==n||!ut(e)&&!ut(n)?e!=e&&n!=n:In(e,n,r,o,t,i))},Ln=function(t){return t==t&&!x(t)},Nn=function(t,e){return function(n){return null!=n&&n[t]===e&&(void 0!==e||t in Object(n))}},Mn=function(t){var e=function(t){for(var e=Ze(t),n=e.length;n--;){var r=e[n],o=t[r];e[n]=[r,o,Ln(o)]}return e}(t);return 1==e.length&&e[0][2]?Nn(e[0][0],e[0][1]):function(n){return n===t||function(t,e,n,r){var o=n.length,i=o,a=!r;if(null==t)return!i;for(t=Object(t);o--;){var s=n[o];if(a&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++o<i;){var c=(s=n[o])[0],l=t[c],u=s[1];if(a&&s[2]){if(void 0===l&&!(c in t))return!1}else{var d=new J;if(r)var f=r(l,u,c,t,e,d);if(!(void 0===f?Fn(u,l,3,r,d):f))return!1}}return!0}(n,t,e)}},Rn=function(t){return"symbol"==typeof t||ut(t)&&"[object Symbol]"==w(t)};var Pn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,$n=/^\w*$/;const Dn=function(t,e){if(mt(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!Rn(t))||$n.test(t)||!Pn.test(t)||null!=e&&t in Object(e)};function Un(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=t.apply(this,r);return n.cache=i.set(o,a)||i,a};return n.cache=new(Un.Cache||W),n}Un.Cache=W;const zn=Un;var qn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Hn=/\\(\\)?/g;const Bn=function(t){var e=zn((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(qn,(function(t,n,r,o){e.push(r?o.replace(Hn,"$1"):n||t)})),e}),(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}();var Wn=h?h.prototype:void 0,Gn=Wn?Wn.toString:void 0;const Jn=function t(e){if("string"==typeof e)return e;if(mt(e))return function(t,e){for(var n=-1,r=null==t?0:t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o}(e,t)+"";if(Rn(e))return Gn?Gn.call(e):"";var n=e+"";return"0"==n&&1/e==-1/0?"-0":n},Zn=function(t,e){return mt(t)?t:Dn(t,e)?[t]:Bn(function(t){return null==t?"":Jn(t)}(t))},Vn=function(t){if("string"==typeof t||Rn(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e},Kn=function(t,e){for(var n=0,r=(e=Zn(e,t)).length;null!=t&&n<r;)t=t[Vn(e[n++])];return n&&n==r?t:void 0},Yn=function(t,e){return null!=t&&e in Object(t)},Qn=function(t,e){return null!=t&&function(t,e,n){for(var r=-1,o=(e=Zn(e,t)).length,i=!1;++r<o;){var a=Vn(e[r]);if(!(i=null!=t&&n(t,a)))break;t=t[a]}return i||++r!=o?i:!!(o=null==t?0:t.length)&&vt(o)&&Dt(a,o)&&(mt(t)||gt(t))}(t,e,Yn)},Xn=function(t,e){return Dn(t)&&Ln(e)?Nn(Vn(t),e):function(n){var r=function(t,e,n){var r=null==t?void 0:Kn(t,e);return void 0===r?n:r}(n,t);return void 0===r&&r===e?Qn(n,t):Fn(e,r,3)}},tr=function(t){return Dn(t)?function(t){return function(e){return null==e?void 0:e[t]}}(Vn(t)):function(t){return function(e){return Kn(e,t)}}(t)},er=function(t,e){var n={};return e=function(t){return"function"==typeof t?t:null==t?Zt:"object"==typeof t?mt(t)?Xn(t[0],t[1]):Mn(t):tr(t)}(e),function(t,e){t&&Y(t,e,Ze)}(t,(function(t,r,o){V(n,e(t,r,o),t)})),n};function nr(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class rr{constructor(t,e){nr(this,"ctx",void 0),nr(this,"serviceHooks",void 0),this.ctx=t,this.serviceHooks=e,t._execCallableAPI("register-search-service",t.baseInfo.id,e.name,e.options),Object.entries({query:{f:"onQuery",args:["graph","q",!0],reply:!0,transformOutput:t=>(mt(null==t?void 0:t.blocks)&&(t.blocks=t.blocks.map((t=>t&&er(t,((t,e)=>`block/${e}`))))),t)},rebuildBlocksIndice:{f:"onIndiceInit",args:["graph","blocks"]},transactBlocks:{f:"onBlocksChanged",args:["graph","data"]},truncateBlocks:{f:"onIndiceReset",args:["graph"]},removeDb:{f:"onGraph",args:["graph"]}}).forEach((([n,r])=>{const o=(t=>`service:search:${t}:${e.name}`)(n);t.caller.on(o,(async n=>{if(C(null==e?void 0:e[r.f])){let i=null;try{i=await e[r.f].apply(e,(r.args||[]).map((t=>{if(n){if(!0===t)return n;if(n.hasOwnProperty(t)){const e=n[t];return delete n[t],e}}}))),r.transformOutput&&(i=r.transformOutput(i))}catch(t){console.error("[SearchService] ",t),i=t}finally{r.reply&&t.caller.call(`${o}:reply`,i)}}}))}))}}function or(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const ir=Symbol.for("proxy-continue"),ar=ye()("LSPlugin:user"),sr=new he("",{console:!0});function cr(t,e,n){var r;if("function"!=typeof n)return!1;const{key:o,label:i,desc:a,palette:s,keybinding:c,extras:l}=e,u=`SimpleCommandHook${o}${++pr}`;this.Editor["on"+u](n),null===(r=this.caller)||void 0===r||r.call("api:call",{method:"register-plugin-simple-command",args:[this.baseInfo.id,[{key:o,label:i,type:t,desc:a,keybinding:c,extras:l},["editor/hook",u]],s]})}function lr(t){var e;return!("string"!=typeof(e=t)||36!==e.length||!/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/gi.test(e))||(sr.error(`#${t} is not a valid UUID string.`),!1)}let ur=null,dr=new Map;const fr={async getInfo(t){return ur||(ur=await this._execCallableAPIAsync("get-app-info")),"string"==typeof t?ur[t]:ur},registerCommand:cr,registerSearchService(t){if(dr.has(t.name))throw new Error(`SearchService: #${t.name} has registered!`);dr.set(t.name,new rr(this,t))},registerCommandPalette(t,e){const{key:n,label:r,keybinding:o}=t;return cr.call(this,"$palette$",{key:n,label:r,palette:!0,keybinding:o},e)},registerCommandShortcut(t,e){const{binding:n}=t,r="$shortcut$",o=r+fe(n);return cr.call(this,r,{key:o,palette:!1,keybinding:t},e)},registerUIItem(t,e){var n;const r=this.baseInfo.id;null===(n=this.caller)||void 0===n||n.call("api:call",{method:"register-plugin-ui-item",args:[r,t,e]})},registerPageMenuItem(t,e){if("function"!=typeof e)return!1;const n=t+"_"+this.baseInfo.id,r=t;cr.call(this,"page-menu-item",{key:n,label:r},e)},onBlockRendererSlotted(t,e){if(!lr(t))return;const n=this.baseInfo.id,r=`hook:editor:${fe(`slot:${t}`)}`;return this.caller.on(r,e),this.App._installPluginHook(n,r),()=>{this.caller.off(r,e),this.App._uninstallPluginHook(n,r)}},invokeExternalPlugin(t,...e){var n;if(!(t=null===(n=t)||void 0===n?void 0:n.trim()))return;let[r,o]=t.split(".");if(!["models","commands"].includes(null==o?void 0:o.toLowerCase()))throw new Error("Type only support '.models' or '.commands' currently.");const i=t.replace(`${r}.${o}.`,"");if(!r||!o||!i)throw new Error(`Illegal type of #${t} to invoke external plugin.`);return this._execCallableAPIAsync("invoke_external_plugin_cmd",r,o.toLowerCase(),i,e)},setFullScreen(t){const e=(...t)=>this._callWin("setFullScreen",...t);"toggle"===t?this._callWin("isFullScreen").then((t=>{t?e():e(!0)})):t?e(!0):e()}};let pr=0;const hr={newBlockUUID(){return this._execCallableAPIAsync("new_block_uuid")},registerSlashCommand(t,e){var n;ar("Register slash command #",this.baseInfo.id,t,e),"function"==typeof e&&(e=[["editor/clear-current-slash",!1],["editor/restore-saved-cursor"],["editor/hook",e]]),e=e.map((t=>{const[e,...n]=t;if("editor/hook"===e){let r=n[0],o=()=>{var t;null===(t=this.caller)||void 0===t||t.callUserModel(r)};"function"==typeof r&&(o=r);const i=`SlashCommandHook${e}${++pr}`;t[1]=i,this.Editor["on"+i](o)}return t})),null===(n=this.caller)||void 0===n||n.call("api:call",{method:"register-plugin-slash-command",args:[this.baseInfo.id,[t,e]]})},registerBlockContextMenuItem(t,e){if("function"!=typeof e)return!1;const n=t+"_"+this.baseInfo.id;cr.call(this,"block-context-menu-item",{key:n,label:t},e)},registerHighlightContextMenuItem(t,e,n){if("function"!=typeof e)return!1;const r=t+"_"+this.baseInfo.id;cr.call(this,"highlight-context-menu-item",{key:r,label:t,extras:n},e)},scrollToBlockInPage(t,e,n){const r="block-content-"+e;null!=n&&n.replaceState?this.App.replaceState("page",{name:t},{anchor:r}):this.App.pushState("page",{name:t},{anchor:r})}},gr={onBlockChanged(t,e){if(!lr(t))return;const n=this.baseInfo.id,r=`hook:db:${fe(`block:${t}`)}`,o=({block:n,txData:r,txMeta:o})=>{n.uuid===t&&e(n,r,o)};return this.caller.on(r,o),this.App._installPluginHook(n,r),()=>{this.caller.off(r,o),this.App._uninstallPluginHook(n,r)}},datascriptQuery(t,...e){return e.pop(),null!=e&&e.some((t=>"function"==typeof t))?this.Experiments.ensureHostScope().logseq.api.datascript_query(t,...e):this._execCallableAPIAsync("datascript_query",t,...e)}},mr={},vr={},yr={makeSandboxStorage(){return new Ue(this,{assets:!0})}};class br extends(le()){constructor(t,e){super(),or(this,"_baseInfo",void 0),or(this,"_caller",void 0),or(this,"_version","0.0.14"),or(this,"_debugTag",""),or(this,"_settingsSchema",void 0),or(this,"_connected",!1),or(this,"_ui",new Map),or(this,"_mFileStorage",void 0),or(this,"_mRequest",void 0),or(this,"_mExperiments",void 0),or(this,"_beforeunloadCallback",void 0),this._baseInfo=t,this._caller=e,e.on("sys:ui:visible",(t=>{null!=t&&t.toggle&&this.toggleMainUI()})),e.on("settings:changed",(t=>{const e=Object.assign({},this.settings),n=Object.assign(this._baseInfo.settings,t);this.emit("settings:changed",{...n},e)})),e.on("beforeunload",(async t=>{const{actor:n,...r}=t,o=this._beforeunloadCallback;try{o&&await o(r),null==n||n.resolve(null)}catch(t){console.debug(`${e.debugTag} [beforeunload] `,t),null==n||n.reject(t)}}))}async ready(t,e){if(!this._connected)try{var n;"function"==typeof t&&(e=t,t={});let r=await this._caller.connectToParent(t);this._connected=!0,r=pe(this._baseInfo,r),null!==(n=r)&&void 0!==n&&n.id&&(this._debugTag=this._caller.debugTag=`#${r.id} [${r.name}]`,this.logger.setTag(this._debugTag)),this._settingsSchema&&(r.settings=function(t,e){const n=(e||[]).reduce(((t,e)=>("default"in e&&(t[e.key]=e.default),t)),{});return Object.assign(n,t)}(r.settings,this._settingsSchema),await this.useSettingsSchema(this._settingsSchema));try{await this._execCallableAPIAsync("setSDKMetadata",{version:this._version})}catch(t){console.warn(t)}e&&e.call(this,r)}catch(t){console.error(`${this._debugTag} [Ready Error]`,t)}}ensureConnected(){if(!this._connected)throw new Error("not connected")}beforeunload(t){"function"==typeof t&&(this._beforeunloadCallback=t)}provideModel(t){return this.caller._extendUserModel(t),this}provideTheme(t){return this.caller.call("provider:theme",t),this}provideStyle(t){return this.caller.call("provider:style",t),this}provideUI(t){return this.caller.call("provider:ui",t),this}useSettingsSchema(t){return this.connected&&this.caller.call("settings:schema",{schema:t,isSync:!0}),this._settingsSchema=t,this}updateSettings(t){this.caller.call("settings:update",t)}onSettingsChanged(t){const e="settings:changed";return this.on(e,t),()=>this.off(e,t)}showSettingsUI(){this.caller.call("settings:visible:changed",{visible:!0})}hideSettingsUI(){this.caller.call("settings:visible:changed",{visible:!1})}setMainUIAttrs(t){this.caller.call("main-ui:attrs",t)}setMainUIInlineStyle(t){this.caller.call("main-ui:style",t)}hideMainUI(t){const e={key:0,visible:!1,cursor:null==t?void 0:t.restoreEditingCursor};this.caller.call("main-ui:visible",e),this.emit("ui:visible:changed",e),this._ui.set(e.key,e)}showMainUI(t){const e={key:0,visible:!0,autoFocus:null==t?void 0:t.autoFocus};this.caller.call("main-ui:visible",e),this.emit("ui:visible:changed",e),this._ui.set(e.key,e)}toggleMainUI(){const t=this._ui.get(0);t&&t.visible?this.hideMainUI():this.showMainUI()}get version(){return this._version}get isMainUIVisible(){const t=this._ui.get(0);return Boolean(t&&t.visible)}get connected(){return this._connected}get baseInfo(){return this._baseInfo}get effect(){var t,e;return this&&((null===(t=this.baseInfo)||void 0===t?void 0:t.effect)||!(null!==(e=this.baseInfo)&&void 0!==e&&e.iir))}get logger(){return sr}get settings(){var t;return null===(t=this.baseInfo)||void 0===t?void 0:t.settings}get caller(){return this._caller}resolveResourceFullUrl(t){if(this.ensureConnected(),t)return t=t.replace(/^[.\\/]+/,""),function(t,...e){try{const n=new URL(t);if(!n.origin)throw new Error(null);const r=de.join(t.substr(n.origin.length),...e);return n.origin+r}catch(n){return de.join(t,...e)}}(this._baseInfo.lsr,t)}_makeUserProxy(t,e){const n=this,r=this.caller;return new Proxy(t,{get(t,o,i){const a=t[o];return function(...t){if(a){const r=a.apply(n,t.concat(e));if(r!==ir)return r}if(e){const i=o.toString().match(/^(once|off|on)/i);if(null!=i){const o=i[0].toLowerCase(),a=i.input.slice(o.length),s="off"===o,c=n.baseInfo.id,l=`hook:${e}:${fe(a)}`,u=t[0];r[o](l,u);const d=()=>{r.off(l,u),r.listenerCount(l)||n.App._uninstallPluginHook(c,l)};return s?void d():(n.App._installPluginHook(c,l),d)}}let i=o;return["git","ui","assets"].includes(e)&&(i=e+"_"+i),r.callAsync("api:call",{tag:e,method:i,args:t})}}})}_execCallableAPIAsync(t,...e){return this._caller.callAsync("api:call",{method:t,args:e})}_execCallableAPI(t,...e){this._caller.call("api:call",{method:t,args:e})}_callWin(...t){return this._execCallableAPIAsync("_callMainWin",...t)}get App(){return this._makeUserProxy(fr,"app")}get Editor(){return this._makeUserProxy(hr,"editor")}get DB(){return this._makeUserProxy(gr,"db")}get Git(){return this._makeUserProxy(mr,"git")}get UI(){return this._makeUserProxy(vr,"ui")}get Assets(){return this._makeUserProxy(yr,"assets")}get FileStorage(){let t=this._mFileStorage;return t||(t=this._mFileStorage=new Ue(this)),t}get Request(){let t=this._mRequest;return t||(t=this._mRequest=new We(this)),t}get Experiments(){let t=this._mExperiments;return t||(t=this._mExperiments=new ze(this)),t}}function _r(t,e){return new br(t,e)}if(null==window.__LSP__HOST__){const t=new $e(null);window.logseq=_r({},t)}})(),a})(),e.exports=r()})),r("3hE9n");logseq.useSettingsSchema([{key:"wordCountStr",type:"string",default:"Word count:",description:"Customise the text that is shown in the word-counter.",title:"Customise word count text"},{key:"characterCountStr",type:"string",default:"Character count:",description:"Customise the text that is shown in the character-counter.",title:"Customise character count text"},{key:"wordTargetStr",type:"string",default:"Writing target:",description:"Customise the text that is shown in the writing target.",title:"Customise writing target text"},{key:"characterTargetStr",type:"string",default:"Character target:",description:"Customise the text that is shown in the character-counter.",title:"Customise character target text"},{key:"forceWordCount",type:"boolean",default:!1,description:"Forces counting cyrillic characters in words instead of individual characters (.e.g for Russian language to be counted correctly)a,",title:"Force Word Count (for Cyrillic characters)"},{key:"toolbar",type:"boolean",default:!1,description:"Displays number of words in toolbar.",title:"Toolbar Wordcount"}]).ready((async()=>{console.log("Wordcount plugin loaded"),logseq.provideStyle('\n\t\t.wordcount-toolbar {\n\t\t\t  font-family: "Courier New", monospace;\n\t\t\t  font-size: 13px;\n\t\t\t  padding: 0 5px;\n\t\t\t  border: 1px solid;\n\t\t\t\tborder-radius: 8px;\n\t\t\t\tvertical-align: middle;\n\t\t}\n\t\t'),logseq.provideStyle('\n\t\t.wordcount-btn {\n\t\t  appearance: none;\n\t\t  background-color: #FAFBFC;\n\t\t  border: 1px solid rgba(27, 31, 35, 0.15);\n\t\t  border-radius: 6px;\n\t\t  box-shadow: rgba(27, 31, 35, 0.04) 0 1px 0, rgba(255, 255, 255, 0.25) 0 1px 0 inset;\n\t\t  box-sizing: border-box;\n\t\t  color: #24292E;\n\t\t  cursor: pointer;\n\t\t  display: inline-block;\n\t\t  font-family: -apple-system, system-ui, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";\n\t\t  font-size: 12px;\n\t\t  font-weight: 500;\n\t\t  line-height: 18px;\n\t\t  list-style: none;\n\t\t  padding: 6px 16px;\n\t\t  position: relative;\n\t\t  transition: background-color 0.2s cubic-bezier(0.3, 0, 0.5, 1);\n\t\t  user-select: none;\n\t\t  -webkit-user-select: none;\n\t\t  touch-action: manipulation;\n\t\t  vertical-align: middle;\n\t\t  white-space: nowrap;\n\t\t  word-wrap: break-word;\n\t\t}\n\n\t\t.wordcount-btn:hover {\n\t\t  background-color: #F3F4F6;\n\t\t  text-decoration: none;\n\t\t  transition-duration: 0.1s;\n\t\t}\n\n\t\t.wordcount-btn:before {\n\t\t  display: none;\n\t\t}\n    '),logseq.Editor.registerSlashCommand("Word count",(async()=>{await logseq.Editor.insertAtEditingCursor("{{renderer :wordcount_}}")})),logseq.Editor.registerSlashCommand("Writing session target",(async()=>{await logseq.Editor.insertAtEditingCursor("{{renderer :wordcount_, 500}}")})),logseq.Editor.registerSlashCommand("Character count",(async()=>{await logseq.Editor.insertAtEditingCursor("{{renderer :wordcountchar_}}")})),logseq.App.onMacroRendererSlotted((async({slot:t,payload:e})=>{const n=e.uuid,[r,o]=e.arguments;if(!r.startsWith(":wordcountchar_")&&!r.startsWith(":wordcount_"))return;const s=`wordcount_${r.split("_")[1]?.trim()}_${t}`,c=await logseq.Editor.getBlock(n,{includeChildren:!0});if(r.startsWith(":wordcount_")){a(t,s,r,o,i(c.children,"words"))}else if(r.startsWith(":wordcountchar_")){a(t,s,r,o,i(c.children,"chars"))}else logseq.UI.showMsg("Please do not change the render parameters except for your writing target.","error")})),logseq.App.onMacroRendererSlotted((async({slot:t,payload:e})=>{const[n,r]=e.arguments;if(!n.startsWith(":wordcount-page_"))return;const o=`wordcount-page_${n.split("_")[1]?.trim()}_${t}`;logseq.provideUI({key:o,slot:t,reset:!0,template:`\n          <span class="wordcount-btn" data-slot-id="${o}" data-wordcount-id="${o}">Wordcount: ${r}</span>`})})),logseq.Editor.registerSlashCommand("Word count - page",(async()=>{await logseq.Editor.insertAtEditingCursor("{{renderer :wordcount-page_, 0}}")}));let t=0;logseq.DB.onChanged((async function({blocks:e}){if(1===e.length){const n=e[0].content;t=o(n);const r=await logseq.Editor.getCurrentBlock();if(r){const e=await logseq.Editor.getPage(r.page.id),n=await logseq.Editor.getPageBlocksTree(e.name);if(n[0].content.includes("{{renderer :wordcount-page_,")){let e=n[0].content;const r=/\{\{renderer :wordcount-page_,(.*?)\}\}/.exec(e);e=e.replace(r[0],`{{renderer :wordcount-page_, ${t}}}`),await logseq.Editor.updateBlock(n[0].uuid,e)}}}logseq.settings.toolbar&&logseq.App.registerUIItem("toolbar",{key:"wordcount-page",template:`<p class="wordcount-toolbar">${t} words</p>`})}))})).catch(console.error);
//# sourceMappingURL=index.86533160.js.map
